<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Kinnitamine</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 40px; background: #f0f0f0; text-align: center; }
    button { margin: 10px; padding: 15px 30px; font-size: 18px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Kinnita või keeldu</h1>
  <p id="pealkiri">Laadin...</p>
  <button onclick="sendResponse('jah')">KINNITA</button>
  <button onclick="sendResponse('ei')">KEELDU</button>
  <p id="result"></p>

  <script>
    const rowId = 'i-dcnD-CUNpB'; // lisa sobiv rea ID siia
    const apiUrl = 'https://script.google.com/macros/s/XXXXXX/exec'; // asenda oma scripti URL-iga

    // Lae pealkiri Coda API-st
    fetch(`${apiUrl}?rowId=${rowId}`)
      .then(res => res.text())
      .then(html => {
        document.body.innerHTML = html;
      })
      .catch(err => {
        document.getElementById('pealkiri').innerText = 'Viga andmete laadimisel.';
      });

    // Saada kinnituse väärtus backendile
    function sendResponse(value) {
      fetch(apiUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ rowId: rowId, value: value })
      })
      .then(res => res.text())
      .then(text => {
        document.getElementById('result').innerText = text;
      })
      .catch(err => {
        document.getElementById('result').innerText = 'Salvestamisel viga.';
      });
    }
  </script>
</body>
</html>
